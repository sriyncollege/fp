<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Faculty Profile — Sri Y. N. College (Autonomous)</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body {font-family: "Times New Roman", Times, serif; padding:18px; color:#000;}
  .page{ width:800px; margin:0 auto; }
  h1{ text-align:center; margin:0; font-size:20px }
  .row{ display:flex; gap:12px; margin-top:12px }
  .col-left{ flex:1 }
  .col-right{ width:140px; text-align:center }
  input, textarea {width:100%; padding:6px; box-sizing:border-box; font-size:14px}
  .photo{ width:120px; height:150px; border:1px solid #000; object-fit:cover; display:block; margin-top:6px }
  .section-title{ font-weight:bold; margin-top:14px; border-bottom:1px solid #000; padding-bottom:4px}
  .controls{ margin-top:12px; display:flex; gap:10px }
  button{ padding:8px 12px; }
  .small{ font-size:12px; color:#333 }
</style>
</head>
<body>

<div class="page">
  <h1>Sri Y. N. College (Autonomous)</h1>
  <h2 style="text-align:center;margin:0">Faculty Profile</h2>

  <div class="row">
    <div class="col-left">
      <label>Full name</label><input id="name" type="text">
      <label>Designation</label><input id="designation" type="text">
      <label>Address</label><textarea id="address"></textarea>
      <label>Mobile Number</label><input id="mobile" type="text">
      <label>E-mail</label><input id="email" type="text">
    </div>

    <div class="col-right">
      <label>Photo (upload)</label>
      <input id="photoUpload" accept="image/*" type="file">
      <img id="photoPreview" class="photo">
      <div class="small">(120 x 150 recommended)</div>
    </div>
  </div>

  <div class="section-title">Educational Qualifications</div>
  <textarea id="education"></textarea>

  <div class="section-title">Career Profile</div>
  <textarea id="career"></textarea>

  <div class="section-title">Administrative Assignments held</div>
  <textarea id="admin"></textarea>

  <div class="section-title">Academic Focus</div>
  <textarea id="focus"></textarea>

  <div class="section-title">Courses Taught</div>
  <textarea id="courses"></textarea>

  <div class="section-title">Publications Profile</div>
  <label>Book Chapters</label><textarea id="pub_chapters"></textarea>
  <label>Research Papers in Journals</label><textarea id="pub_journals"></textarea>
  <label>Paper Presentations</label><textarea id="pub_present"></textarea>

  <div class="section-title">Awards and Distinctions</div>
  <textarea id="awards"></textarea>

  <div class="section-title">Association with Professional Bodies</div>
  <textarea id="assoc"></textarea>

  <div class="section-title">Other Activities</div>
  <textarea id="other"></textarea>

  <div class="controls">
    <button onclick="previewLocal()">Preview & Print</button>
    <button onclick="submitProfile()">Submit</button>
    <button onclick="saveLocal()">Save Locally</button>
    <button onclick="loadLocal()">Load Last Saved</button>
  </div>

  <div id="status" style="margin-top:8px;color:green"></div>
</div>

<script>
function el(id){ return document.getElementById(id); }

// Photo Preview
el('photoUpload').addEventListener('change', function(e){
  const f = e.target.files[0];
  const reader = new FileReader();
  reader.onload = () => el('photoPreview').src = reader.result;
  reader.readAsDataURL(f);
});

// Collect Data
function collect(){
  return {
    name: el('name').value,
    designation: el('designation').value,
    address: el('address').value,
    mobile: el('mobile').value,
    email: el('email').value,
    education: el('education').value,
    career: el('career').value,
    admin: el('admin').value,
    focus: el('focus').value,
    courses: el('courses').value,
    pub_chapters: el('pub_chapters').value,
    pub_journals: el('pub_journals').value,
    pub_present: el('pub_present').value,
    awards: el('awards').value,
    assoc: el('assoc').value,
    other: el('other').value,
    photo: el('photoPreview').src
  };
}

// ✅ FORMATTED PREVIEW & PRINT (NO PRINCIPAL / NO IQAC)
function previewLocal(){
  const data = collect();
  const safe = s => (s||'').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>');

  const html = `
<!doctype html>
<html><head>
<meta charset="utf-8">
<title>Faculty Profile</title>
<style>
body{font-family:"Times New Roman",serif;padding:28px;color:#000}
h1,h2{text-align:center;margin:0}
table{width:100%;border-collapse:collapse;margin-top:8px}
td{padding:6px;vertical-align:top}
h3{border-bottom:1px solid #000;padding-bottom:4px;margin-top:14px}
</style>
</head>
<body>

<h1>Sri Y. N. College (Autonomous)</h1>
<h2>Faculty Profile</h2>

<div style="display:flex;gap:12px;margin-top:12px">
<div style="flex:1">
<div style="font-weight:bold;font-size:16px">${safe(data.name)}</div>
<table>
<tr><td width="160"><b>Designation</b></td><td>${safe(data.designation)}</td></tr>
<tr><td><b>Address</b></td><td>${safe(data.address)}</td></tr>
<tr><td><b>Mobile</b></td><td>${safe(data.mobile)}</td></tr>
<tr><td><b>Email</b></td><td>${safe(data.email)}</td></tr>
</table>
</div>
<div style="width:150px;text-align:center">
${data.photo ? `<img src="${data.photo}" width="120" height="150" style="border:1px solid #000">` : ''}
</div>
</div>

<h3>Educational Qualifications</h3>${safe(data.education)}
<h3>Career Profile</h3>${safe(data.career)}
<h3>Administrative Assignments held</h3>${safe(data.admin)}
<h3>Academic Focus</h3>${safe(data.focus)}
<h3>Courses Taught</h3>${safe(data.courses)}

<h3>Publications Profile</h3>
<b>Book Chapters</b><br>${safe(data.pub_chapters)}<br><br>
<b>Research Papers in Journals</b><br>${safe(data.pub_journals)}<br><br>
<b>Paper Presentations</b><br>${safe(data.pub_present)}

<h3>Awards and Distinctions</h3>${safe(data.awards)}
<h3>Association with Professional Bodies</h3>${safe(data.assoc)}
<h3>Other Activities</h3>${safe(data.other)}

<div style="margin-top:15px">
<button onclick="window.print()">Print / Save as PDF</button>
</div>

</body></html>`;

  const w = window.open('', '_blank', 'width=900,height=1100,scrollbars=yes');
  w.document.write(html);
  w.document.close();
}

// Save Local
function saveLocal(){
  localStorage.setItem('faculty_profile_last', JSON.stringify(collect()));
  alert("Saved locally");
}

// Load Local
function loadLocal(){
  const s = localStorage.getItem('faculty_profile_last');
  if(!s){ alert("No saved data"); return; }
  const d = JSON.parse(s);
  for(let k in d) if(el(k)) el(k).value = d[k];
  if(d.photo) el('photoPreview').src = d.photo;
  alert("Loaded");
}

// ✅ SUBMIT TO GOOGLE DRIVE (NO CORS)
async function submitProfile(){
  const data = collect();

  if(!data.name || !data.email){
    alert("Enter Name and Email");
    return;
  }

  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwJxCODAO8LHyBAEvolUoKkAe1QGeyF-i3UkyGM7CTV5n8ZZEdFGU8aFPZKDG8xTI7J/exec";

  el('status').innerText = "Submitting...";

  try{
    await fetch(WEB_APP_URL, {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    el('status').style.color = "green";
    el('status').innerText = "✅ Submitted Successfully!";
    alert("✅ Submitted Successfully!");

  } catch(err){
    el('status').style.color = "red";
    el('status').innerText = "❌ Submit Failed";
    alert("❌ Submit Failed");
  }
}
</script>

</body>
</html>
