<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Faculty Profile â€” Sri Y. N. College (Autonomous)</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body {font-family: "Times New Roman", Times, serif; padding:18px; color:#000;}
  .page{ width:800px; margin:0 auto; }
  h1{ text-align:center; margin:0; font-size:20px }
  .row{ display:flex; gap:12px; margin-top:12px }
  .col-left{ flex:1 }
  .col-right{ width:140px; text-align:center }
  input, textarea {width:100%; padding:6px; box-sizing:border-box; font-size:14px}
  .photo{ width:120px; height:150px; border:1px solid #000; object-fit:cover; display:block; margin-top:6px }
  .section-title{ font-weight:bold; margin-top:14px; border-bottom:1px solid #000; padding-bottom:4px}
  .controls{ margin-top:12px; display:flex; gap:10px }
  button{ padding:8px 12px; }
  .small{ font-size:12px; color:#333 }
</style>
</head>
<body>
<div class="page">
  <h1>Sri Y. N. College (Autonomous)</h1>
  <h2 style="text-align:center;margin:0">Faculty Profile</h2>

  <div class="row">
    <div class="col-left">
      <label>Full name</label><input id="name" type="text" placeholder="Mr. Vinaya Phaneendhra K">

      <label>Designation</label><input id="designation" type="text" placeholder="Assistant Professor">

      <label>Address</label><textarea id="address" placeholder="Department of Electronics, Sri Y N College(A), Narsapur-534275, Andhra Pradesh, India"></textarea>

      <label>Mobile Number</label><input id="mobile" type="text" placeholder="+919493992710">

      <label>E-mail</label><input id="email" type="text" placeholder="vinayscindia@gmail.com">
    </div>
    <div class="col-right">
      <label>Photo (upload)</label><input id="photoUpload" accept="image/*" type="file">
      <img id="photoPreview" class="photo" src="">
      <div class="small">(120 x 150 recommended)</div>
    </div>
  </div>

  <div class="section-title">Educational Qualifications</div>
  <textarea id="education"></textarea>

  <div class="section-title">Career Profile</div>
  <textarea id="career"></textarea>

  <div class="section-title">Administrative Assignments held</div>
  <textarea id="admin"></textarea>

  <div class="section-title">Academic Focus</div>
  <textarea id="focus"></textarea>

  <div class="section-title">Courses Taught</div>
  <textarea id="courses"></textarea>

  <div class="section-title">Publications Profile</div>
  <label>Book Chapters</label><textarea id="pub_chapters"></textarea>
  <label>Research Papers in Journals</label><textarea id="pub_journals"></textarea>
  <label>Paper Presentations</label><textarea id="pub_present"></textarea>

  <div class="section-title">Awards and Distinctions</div>
  <textarea id="awards"></textarea>

  <div class="section-title">Association with Professional Bodies</div>
  <textarea id="assoc"></textarea>

  <div class="section-title">Other Activities</div>
  <textarea id="other"></textarea>

  <div class="controls">
    <button onclick="previewLocal()">Preview & Print</button>
    <button onclick="submitProfile()">Submit</button>
    <button onclick="saveLocal()">Save Locally</button>
    <button onclick="loadLocal()">Load Last Saved</button>
  </div>

  <div id="status" style="margin-top:8px;color:green"></div>
</div>

<script>
  // ---------- helper functions ----------
  function el(id){return document.getElementById(id);}
  el('photoUpload').addEventListener('change', function(e){
    const f = e.target.files[0]; if(!f) return;
    const reader = new FileReader();
    reader.onload = function(evt){ el('photoPreview').src = evt.target.result; };
    reader.readAsDataURL(f);
  });

  function collect(){
    return {
      name: el('name').value || '',
      designation: el('designation').value || '',
      address: el('address').value || '',
      mobile: el('mobile').value || '',
      email: el('email').value || '',
      education: el('education').value || '',
      career: el('career').value || '',
      admin: el('admin').value || '',
      focus: el('focus').value || '',
      courses: el('courses').value || '',
      pub_chapters: el('pub_chapters').value || '',
      pub_journals: el('pub_journals').value || '',
      pub_present: el('pub_present').value || '',
      awards: el('awards').value || '',
      assoc: el('assoc').value || '',
      other: el('other').value || '',
      photo: el('photoPreview').src || ''
    };
  }

  // Preview & Print (local)
  function previewLocal(){
    // Create a small popup window with formatted content (matching PDF)
    const data = collect();
    const html = buildPreviewHTML(data);
    const w = window.open('', '_blank', 'width=900,height=1100,scrollbars=yes');
    w.document.write(html);
    w.document.close();
  }

  function buildPreviewHTML(data){
    const safe = function(s){ return (s||'').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>'); };
    return `
      <!doctype html><html><head>
      <meta charset="utf-8"><title>Preview</title>
      <style>body{font-family:Times New Roman,serif;padding:28px;color:#000}h1{text-align:center}table{width:100%;border-collapse:collapse}td{vertical-align:top;padding:6px}</style>
      </head><body>
      <h1>Sri Y. N. College (Autonomous)</h1>
      <h2 style="text-align:center;margin-top:0">Faculty Profile</h2>
      <div style="display:flex;gap:12px;margin-top:12px">
        <div style="flex:1">
          <div style="font-weight:bold;font-size:16px">${safe(data.name)}</div>
          <table><tr><td style="width:160px;font-weight:bold">Designation</td><td>${safe(data.designation)}</td></tr>
          <tr><td style="font-weight:bold">Address</td><td>${safe(data.address)}</td></tr>
          <tr><td style="font-weight:bold">Mobile Number</td><td>${safe(data.mobile)}</td></tr>
          <tr><td style="font-weight:bold">E-mail</td><td>${safe(data.email)}</td></tr></table>
        </div>
        <div style="width:150px;text-align:center">
          ${ data.photo ? `<img src="${data.photo}" style="width:120px;height:150px;object-fit:cover;border:1px solid #000">` : '' }
        </div>
      </div>
      <h3>Educational Qualifications</h3><div>${safe(data.education)}</div>
      <h3>Career Profile</h3><div>${safe(data.career)}</div>
      <h3>Administrative Assignments held</h3><div>${safe(data.admin)}</div>
      <h3>Academic Focus</h3><div>${safe(data.focus)}</div>
      <h3>Courses Taught</h3><div>${safe(data.courses)}</div>
      <h3>Publications Profile</h3>
      <div><strong>Book Chapters</strong><div>${safe(data.pub_chapters)}</div>
      <strong>Research Papers in Journals</strong><div>${safe(data.pub_journals)}</div>
      <strong>Paper Presentations</strong><div>${safe(data.pub_present)}</div></div>
      <h3>Awards and Distinctions</h3><div>${safe(data.awards)}</div>
      <h3>Association with Professional Bodies</h3><div>${safe(data.assoc)}</div>
      <h3>Other Activities</h3><div>${safe(data.other)}</div>
      <div style="display:flex;gap:20px;margin-top:20px">
        <div><strong>Principal / Dean</strong><div style="height:60px;border-bottom:1px solid #000"></div><div>Dr. Ch. Kanaka Rao</div></div>
        <div><strong>IQAC Coordinator</strong><div style="height:60px;border-bottom:1px solid #000"></div><div>Dr. G. S. Rama Krishna</div></div>
      </div>
      <div style="margin-top:10px"><button onclick="window.print()">Print / Save as PDF</button></div>
      </body></html>`;
  }

  // Save locally in browser (for editing later)
  function saveLocal(){
    localStorage.setItem('faculty_profile_last', JSON.stringify(collect()));
    alert('Saved locally in browser.');
  }
  function loadLocal(){
    const s = localStorage.getItem('faculty_profile_last');
    if(!s){ alert('No saved data'); return; }
    const r = JSON.parse(s);
    for(var k in r){ if(document.getElementById(k)) document.getElementById(k).value = r[k]; }
    if(r.photo) document.getElementById('photoPreview').src = r.photo;
    alert('Loaded saved data.');
  }

  // SUBMIT to Apps Script Web App
  async function submitProfile(){
    const data = collect();
    if(!data.name || !data.email){ alert('Please add Name and Email before submitting'); return; }

    // Replace with your Apps Script Web App URL:
    const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbz13k430PDTSX7dNjBh9ix3dWHAyQhsdmpjTkyZd1BJK2uK1w3wGZoGPv4_OlktvPOX/exec';  // <<-- REPLACE THIS

    el('status').innerText = 'Submitting...';
    try{
      const res = await fetch(WEB_APP_URL, {
        method: 'POST',
        headers: { 'Content-Type':'application/json' },
        body: JSON.stringify(data)
      });
      const j = await res.json();
      if(j.status === 'ok'){
        el('status').style.color = 'green';
        el('status').innerHTML = 'Submitted successfully. PDF: <a target="_blank" href="'+j.pdfUrl+'">Open PDF</a>';
      } else {
        el('status').style.color = 'red';
        el('status').innerText = 'Submit error: ' + (j.message || JSON.stringify(j));
      }
    } catch(err){
      el('status').style.color = 'red';
      el('status').innerText = 'Submit failed: ' + err;
    }
  }
</script>
</body>
</html>
